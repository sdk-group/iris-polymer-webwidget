<script>
  //@NOTE: draft of irisCdn
  window.IRIS = window.IRIS || {};

  var request = function(uri, data) {
    return fetch(uri, {
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
      method: 'POST',
      body: JSON.stringify(data)
    })
  }

  window.IRIS.webwidget = {
    token: "1234567",
    getTerminals() {
      return Promise.resolve([{
        label: "Терминал-1",
        id: "term-1"
      }, {
        label: "Терминал-2",
        id: "term-2"
      }, {
        label: "Терминал-3",
        id: "term-3"
      }, {
        label: "Терминал-2",
        id: "term-2"
      }, {
        label: "Терминал-3",
        id: "term-3"
      }]).delay(1000);

      return request('/agen/info').then(d => d.available_ws)
    },
    getTerminalLayout(terminal_id) {
      return Promise.resolve({
        base: {
          root: {
            content: [{
              id: "service-1",
              label: "Услуга 1"
            }, {
              id: "service-2",
              label: "Услуга 2"
            }, {
              id: "service-3",
              label: "Услуга 3"
            }]
          }
        }
      }).delay(1000);
    },
    getAvailableDays(ticket_query) {
      //user_info = {service_count: Number, service: String}
      ///uri : prebook/available-days Object
      return {
        days: [{
          date: "2016-06-13T06:55:28+05:00",
          is_available: false
        }],
        done: false
      };
    },
    getDaySlots(ticket_query) {
      //user_info = {service_count: Number, service: String, dedicated_date: DateString}
      //url: /prebook/ticket-observe
      return {
        slots: [{
          time_description: [0, 1800]
        }, {
          time_description: [1800, 3600]
        }]
      }
    },
    confirmTicket(ticket_query) {
      //uri: /prebook/ticket-confirm
      return {
        context: {},
        ticket: {
          id: "ticket-department-1-2016-06-14--2",
          code: "0012565262",
          time_description: [0, 900],
          dedicated_date: "2016-06-14"
        }
      }
    }
  };
</script>

<script src="../lodash/dist/lodash.min.js"></script>
<script src="../moment/min/moment.min.js"></script>
<script src="../moment/locale/ru.js"></script>
<script src="../bluebird/js/browser/bluebird.min.js"></script>